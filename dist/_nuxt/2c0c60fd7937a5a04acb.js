(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{473:function(t,e,r){var content=r(476);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(19).default)("8183a152",content,!0,{sourceMap:!1})},474:function(t,e,r){var content=r(479);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(19).default)("5e148abe",content,!0,{sourceMap:!1})},475:function(t,e,r){"use strict";var o=r(473);r.n(o).a},476:function(t,e,r){(e=r(18)(!1)).push([t.i,".custom-card-table{padding-bottom:50px}.custom-card-table .title{border-radius:5px}.custom-card-table.purple .title{background:#fff}.custom-card-table.yellow .title{background:#e5e500;color:#000}.custom-card-table.orange .title{background:#ff4500;color:#fff}.custom-card-table.green .title{background:#33b105;color:#fff}.custom-card-table.purple .title{background:#9103b1;color:#fff}.custom-card-table .title{background:#0767c6;padding:15px;color:#fff;font-weight:700}.custom-card-table .actions{text-align:right;padding:10px 15px}.custom-card-table .content{padding:15px}.custom-paginator{padding:25px}",""]),t.exports=e},477:function(t,e,r){"use strict";var o={name:"TableGeneral",props:["title","color"]},l=(r(475),r(10)),component=Object(l.a)(o,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{class:" custom-card-table "+this.color},[e("div",{staticClass:"title"},[this._v(this._s(this.title))]),this._v(" "),this._t("default")],2)}),[],!1,null,null,null);e.a=component.exports},478:function(t,e,r){"use strict";var o=r(474);r.n(o).a},479:function(t,e,r){(e=r(18)(!1)).push([t.i,".TitleSection{color:#409eff;padding:25px 15px;text-transform:uppercase}",""]),t.exports=e},480:function(t,e,r){"use strict";var o={props:["title"]},l=(r(478),r(10)),component=Object(l.a)(o,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"TitleSection"},[e("h2",[this._v(this._s(this.title))])])}),[],!1,null,null,null);e.a=component.exports},495:function(t,e,r){var content=r(524);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(19).default)("01e33cca",content,!0,{sourceMap:!1})},523:function(t,e,r){"use strict";var o=r(495);r.n(o).a},524:function(t,e,r){(e=r(18)(!1)).push([t.i,".report .el-row{padding-top:15px}.report .el-card{margin-top:15px}",""]),t.exports=e},544:function(t,e,r){"use strict";r.r(e);r(20);var o=r(3),l=r(480),n=r(477),c=r(481),d=r.n(c),m={layout:"dashboard",middleware:["auth"],transition:{name:"default",mode:"out-in"},components:{TitleSection:l.a,TableGeneral:n.a},head:function(){return{title:"Actualización de servicio"}},data:function(){return{notUpdate:!1,catalog_repairs:[],report:{},dialogImageUrl:"",dialogVisible:!1,upload:{url:"http://api.diken.mx/api/files",headers:{Authorization:this.$auth.getToken("local")},data:{model_id:"",model:0},list:[]},rules:{costs:[{required:!0,message:"Ingresa un costo",trigger:"blur"}]}}},methods:{saveFile:function(t){return{category:t,model_id:this.upload.data.model_id,model:this.upload.data.model}},filterImagesByCategory:function(t){return d.a.filter(this.upload.list,{category:t})},handleRemove:function(t,e){var r=this;return Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.$axios.$delete("http://api.diken.mx/api/files/"+t.id);case 2:case"end":return e.stop()}}),e)})))()},handlePictureCardPreview:function(t){this.dialogImageUrl=t.url,this.dialogVisible=!0},AddExtraCost:function(){this.report.costs.unshift({description:"",cost:0})},AddExtraCostRepair:function(){this.report.costs_repairs.unshift({repair_id:"",cost:0})},init:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var data,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$axios.$get("http://api.diken.mx/api/services/"+t.$route.params.service_id+"/reports/"+t.$route.params.id);case 2:return data=e.sent,e.next=5,t.$axios.$get("http://api.diken.mx/api/repairs/?limit=350&order_by=name");case 5:return r=e.sent,e.next=8,r.data.rows;case 8:return t.catalog_repairs=e.sent,e.next=11,data.data.report;case 11:t.report=e.sent,t.upload.data.model=data.data.report.model,t.upload.data.model_id=data.data.report.id,t.upload.list=d.a.map(data.data.report.files,(function(t){return{name:"name",url:t.url,id:t.id,category:t.category}}));case 15:case"end":return e.stop()}}),e)})))()},submitForm:function(t){var e=this;this.$refs[t].validate((function(t){if(!t)return!1;e.$axios.patch("http://api.diken.mx/api/services/"+e.$route.params.service_id+"/reports/"+e.$route.params.id,e.report).then((function(t){e.$notify({title:"Correcto",message:"El reporte ha sido actualizado",type:"success"}),e.report=t.data.data.report})).catch((function(t){e.$notify.error({title:"Error",message:"El reporte no ha podido ser actualizado"})}))}))}},mounted:function(){},fetch:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.init();case 2:case"end":return e.stop()}}),e)})))()}},v=(r(523),r(10)),component=Object(v.a)(m,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"report"},[t.$fetchState.pending?r("p",{staticClass:"primary-color"},[t._v("Cargando datos del reporte ...")]):r("TableGeneral",{attrs:{title:"Reporte de actividades",color:"purple"}},[r("el-row",[r("el-col",{attrs:{md:24}},[r("el-card",[r("p",[t._v("Este es el reporte detallado para el producto "),r("b",[t._v(t._s(t.report.product_user.product.name))]),t._v("\n            el cual se encuentra asociado al cliente "),r("b",[t._v(t._s(t.report.product_user.client.company_name))])])]),t._v(" "),r("el-card",[r("el-row",{staticStyle:{"text-align":"center"}},[r("el-col",{attrs:{md:8}},[r("p",[r("b",[t._v("Progreso de servicio")])]),t._v(" "),r("br"),t._v(" "),r("el-progress",{attrs:{percentage:t.report.progress}})],1),t._v(" "),r("el-col",{attrs:{md:8}},[r("p",[r("b",[t._v("Creación del reporte")])]),t._v(" "),r("br"),t._v(" "),r("p",[t._v(t._s(t.$convertDateToHuman(t.report.created_at)))])]),t._v(" "),r("el-col",{attrs:{md:8}},[r("p",[r("b",[t._v("Última actualización")])]),t._v(" "),r("br"),t._v(" "),r("p",[t._v(t._s(t.$convertDateToHuman(t.report.updated_at)))])])],1)],1),t._v(" "),r("el-form",{ref:"reportForm",attrs:{model:t.report,rules:t.rules}},[r("el-card",[r("el-row",{attrs:{gutter:25}},[r("el-col",{attrs:{md:24}},[r("h3",{staticStyle:{padding:"20px 0px"}},[t._v("Datos del reporte")])]),t._v(" "),r("el-col",{attrs:{md:8}},[r("el-form-item",{attrs:{label:"Fecha de inicio",prop:"service_start"}},[r("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"Fecha de inicio"},model:{value:t.report.service_start,callback:function(e){t.$set(t.report,"service_start",e)},expression:"report.service_start"}})],1)],1),t._v(" "),r("el-col",{attrs:{md:8}},[r("el-form-item",{attrs:{label:"Fecha de termino",prop:"service_end"}},[r("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"Aún no es asignada la fecha de termino"},model:{value:t.report.service_end,callback:function(e){t.$set(t.report,"service_end",e)},expression:"report.service_end"}})],1)],1),t._v(" "),r("el-col",{attrs:{md:8}},[r("el-form-item",{attrs:{label:"Estatus de reporte",prop:"status"}},[r("el-select",{attrs:{placeholder:"Selecciona un estatus"},model:{value:t.report.status,callback:function(e){t.$set(t.report,"status",e)},expression:"report.status"}},[r("el-option",{attrs:{label:"Pendiente",value:"pendiente"}}),t._v(" "),r("el-option",{attrs:{label:"Cancelado",value:"cancelado"}}),t._v(" "),r("el-option",{attrs:{label:"En proceso",value:"en_proceso"}}),t._v(" "),r("el-option",{attrs:{label:"Terminado",value:"terminado"}})],1)],1)],1)],1),t._v(" "),r("el-row",[r("el-col",{attrs:{md:24}},[r("el-form-item",{attrs:{label:"Observaciones y correcciones del servicio"}},[r("el-input",{attrs:{type:"textarea",rows:"5"},model:{value:t.report.description,callback:function(e){t.$set(t.report,"description",e)},expression:"report.description"}})],1)],1)],1),t._v(" "),r("el-row",{attrs:{gutter:25}},[r("el-col",{attrs:{md:24}},[r("h3",{staticStyle:{padding:"20px 0"}},[t._v("Forma de uso encontrada")])]),t._v(" "),r("el-col",{attrs:{md:8}},[r("el-form-item",{attrs:{label:"Dilución",prop:"dilution"}},[r("el-input",{model:{value:t.report.dilution,callback:function(e){t.$set(t.report,"dilution",e)},expression:"report.dilution"}})],1)],1),t._v(" "),r("el-col",{attrs:{md:8}},[r("el-form-item",{attrs:{label:"Frecuencía",prop:"frequency"}},[r("el-input",{model:{value:t.report.frequency,callback:function(e){t.$set(t.report,"frequency",e)},expression:"report.frequency"}})],1)],1),t._v(" "),r("el-col",{attrs:{md:8}},[r("el-form-item",{attrs:{label:"Método",prop:"method"}},[r("el-input",{model:{value:t.report.method,callback:function(e){t.$set(t.report,"method",e)},expression:"report.method"}})],1)],1)],1),t._v(" "),r("el-row",{attrs:{gutter:25}},[r("el-col",{attrs:{md:12}},[r("h3",{staticStyle:{padding:"20px 0"}},[t._v("Costos extras")]),t._v(" "),r("el-button",{attrs:{type:"primary",plain:""},on:{click:t.AddExtraCost}},[t._v("Agregar un costo extra")]),t._v(" "),t.report.costs.length>0?r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{md:16}},[t._v("Descripción")]),t._v(" "),r("el-col",{attrs:{md:8}},[t._v("Costo")])],1):t._e(),t._v(" "),t._l(t.report.costs,(function(e,o){return r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{md:16}},[r("el-input",{attrs:{type:"text",placeholder:"Descripción del costo"},model:{value:e.description,callback:function(r){t.$set(e,"description",r)},expression:"cost.description"}})],1),t._v(" "),r("el-col",{attrs:{md:8}},[r("el-input",{attrs:{type:"number",placeholder:"Costo"},model:{value:e.cost,callback:function(r){t.$set(e,"cost",r)},expression:"cost.cost"}})],1)],1)}))],2),t._v(" "),r("el-col",{attrs:{md:12}},[r("h3",{staticStyle:{padding:"20px 0"}},[t._v("Costos de refacciones")]),t._v(" "),r("el-button",{attrs:{type:"primary",plain:""},on:{click:t.AddExtraCostRepair}},[t._v("Agregar una refacción")]),t._v(" "),t.report.costs_repairs.length>0?r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{md:16}},[t._v("Refacción")]),t._v(" "),r("el-col",{attrs:{md:8}},[t._v("Costo")])],1):t._e(),t._v(" "),t._l(t.report.costs_repairs,(function(e){return r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{md:16}},[r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"Selecciona una refacción",filterable:""},model:{value:e.repair_id,callback:function(r){t.$set(e,"repair_id",r)},expression:"cost.repair_id"}},t._l(t.catalog_repairs,(function(t){return r("el-option",{attrs:{label:t.name,value:t.id}})})),1)],1),t._v(" "),r("el-col",{attrs:{md:8}},[r("el-input",{attrs:{type:"number",placeholder:"Costo"},model:{value:e.cost,callback:function(r){t.$set(e,"cost",r)},expression:"cost.cost"}})],1)],1)}))],2)],1),t._v(" "),r("el-row",[r("el-col",{attrs:{md:24}},[r("h3",{staticStyle:{padding:"20px 0"}},[t._v("Adjuntar evidencía")])]),t._v(" "),r("el-col",{attrs:{md:24}},[r("div",{staticClass:"images-upload"},[r("el-upload",{attrs:{accept:"image/png, image/jpeg",action:t.upload.url,multiple:!0,headers:t.upload.headers,data:t.saveFile("report"),"file-list":t.filterImagesByCategory("report"),"list-type":"picture-card","on-preview":t.handlePictureCardPreview,"on-remove":t.handleRemove}},[r("i",{staticClass:"el-icon-plus"})]),t._v(" "),r("el-dialog",{attrs:{visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[r("img",{attrs:{width:"100%",src:t.dialogImageUrl,alt:""}})])],1)])],1),t._v(" "),r("el-row",[r("el-col",{attrs:{md:24}},[r("div",{staticStyle:{padding:"25px 0"}},[r("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submitForm("reportForm")}}},[t._v("Actualizar reporte")])],1)])],1)],1)],1)],1)],1)],1)],1)}),[],!1,null,null,null);e.default=component.exports}}]);