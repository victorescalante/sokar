(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{474:function(t,e,r){var content=r(479);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(19).default)("5e148abe",content,!0,{sourceMap:!1})},478:function(t,e,r){"use strict";var o=r(474);r.n(o).a},479:function(t,e,r){(e=r(18)(!1)).push([t.i,".TitleSection{color:#409eff;padding:25px 15px;text-transform:uppercase}",""]),t.exports=e},480:function(t,e,r){"use strict";var o={props:["title"]},n=(r(478),r(10)),component=Object(n.a)(o,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"TitleSection"},[e("h2",[this._v(this._s(this.title))])])}),[],!1,null,null,null);e.a=component.exports},492:function(t,e,r){var content=r(518);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(19).default)("9c4374f4",content,!0,{sourceMap:!1})},517:function(t,e,r){"use strict";var o=r(492);r.n(o).a},518:function(t,e,r){(e=r(18)(!1)).push([t.i,".product-card{cursor:pointer;padding:15px;border:1px solid #2d9c03;border-radius:10px;text-align:center}.product-card.cancel{border:1px solid #3c5fe0}.product-card.cancel .product_name{color:#3c5fe0}.product-card.danger{border:1px solid #d90e0e}.product-card.danger .product_name{color:#d90e0e}.product-card .date{font-size:12px}.product-card .date p{font-weight:700}.product-card .serial_number{font-size:10px}.product-card .product_name{color:#2d9c03;font-weight:700;padding:0}.mini-form-product label{display:block;width:100%;text-align:left}.mini-form-product .el-select{width:100%}.table-products{padding:25px 15px}.table-products .body-products,.table-products .body-products .row-custom,.table-products p{padding-top:15px}.table-products .body-products .row-custom.row-header{font-weight:700}",""]),t.exports=e},529:function(t,e,r){"use strict";r.r(e);var o=r(480),n=(r(20),r(3)),c=(r(0),{name:"TableProducts",props:["data","color"],data:function(){return{loadingProduct:!1,windowWidth:0,openAddProduct:!1,products:[],form:{product_type:"",product_id:"",status:!0}}},mounted:function(){var t=this;this.windowWidth=window.innerWidth,window.addEventListener("resize",(function(){t.windowWidth=window.innerWidth}))},fetch:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getProducts();case 2:case"end":return e.stop()}}),e)})))()},methods:{getProducts:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$axios.$get("http://api.diken.mx/api/products");case 2:r=e.sent,t.products=r.data.rows;case 4:case"end":return e.stop()}}),e)})))()},redirectRelation:function(t){this.$router.push("/clients/"+this.$route.params.client_id+"/product-relation/"+t)},checkDate:function(t){var e=new Date(t).getTime();return Date.now()-e>=0?"danger":""},submitForm:function(t){var e=this;this.loadingProduct=!0,this.$refs[t].validate((function(t){if(!t)return!1;e.$axios.post("http://api.diken.mx/api/clients/"+e.$route.params.client_id+"/product-relation",e.form).then((function(t){e.$notify({title:"Correcto",message:"El producto fue asignado correctamente",type:"success"}),e.$emit("updateProductsList"),e.openAddProduct=!1,e.loadingProduct=!1})).catch((function(t){console.log("El servicio no ha posido ser creado"),e.loadingProduct=!1}))}))}}}),l=(r(517),r(10)),d=Object(l.a)(c,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"table-products"},[r("el-row",[r("el-col",{attrs:{md:24}},[r("h3",[t._v("Administrar los equipos del cliente")]),t._v(" "),r("br"),t._v(" "),r("el-button",{attrs:{type:"primary",plain:""},on:{click:function(e){t.openAddProduct=!0}}},[t._v("Agregar equipo a cliente")]),t._v(" "),t.data.length>=1?r("el-button",{attrs:{type:"info",plain:""},on:{click:function(e){return t.$router.push("/services/create")}}},[t._v("Realizar mantenimiento")]):t._e()],1),t._v(" "),r("el-col",{attrs:{md:24}},[r("p",{staticStyle:{padding:"25px 0"}},[r("strong",[t._v("Número de serie:")]),t._v(" El número de serie es asignado al momento de agregar un producto del catálogo al cliente.")])])],1),t._v(" "),r("div",{staticClass:"body-products"},[r("el-row",{attrs:{gutter:15}},t._l(t.data,(function(e){return r("el-col",{staticStyle:{"padding-top":"15px"},attrs:{xs:12,md:8}},[r("div",{staticClass:"product-card",class:t.checkDate(e.next_service),on:{click:function(r){return t.redirectRelation(e.id)}}},[r("el-row",[r("el-col",{attrs:{md:24}},[r("p",{staticClass:"product_name"},[t._v(t._s(e.product.name))]),t._v(" "),r("p",{staticClass:"serial_number"},[t._v(t._s(e.serial_number))])])],1),t._v(" "),r("el-row",{staticClass:"date"},[r("el-col",{attrs:{md:24}},[r("p",[t._v("Última fecha de servicio")]),t._v(" "),r("span",[t._v(t._s(t.$convertDate(e.last_service)))])]),t._v(" "),r("el-col",{attrs:{md:24}},[r("p",[t._v("Proxima fecha de servicio")]),t._v(" "),r("span",[t._v(t._s(t.$convertDate(e.next_service)))])])],1),t._v(" "),r("el-row",[r("el-col",{attrs:{md:12,offset:12}})],1)],1)])})),1)],1),t._v(" "),r("el-dialog",{attrs:{title:"Asignar equipo a cliente",visible:t.openAddProduct,width:t.$getWidthModal(t.windowWidth)},on:{"update:visible":function(e){t.openAddProduct=e}}},[r("el-row",{directives:[{name:"loading",rawName:"v-loading",value:t.loadingProduct,expression:"loadingProduct"}]},[r("el-form",{ref:"formProduct",staticClass:"mini-form-product",attrs:{model:t.form}},[r("el-col",{attrs:{md:24}},[r("el-form-item",{attrs:{label:"Tipo de Equipo"}},[r("el-select",{attrs:{placeholder:"Selecciona el tipo de equipo"},model:{value:t.form.product_type,callback:function(e){t.$set(t.form,"product_type",e)},expression:"form.product_type"}},[r("el-option",{attrs:{label:"Propio",value:"own"}}),t._v(" "),r("el-option",{attrs:{label:"Comodato",value:"borrowed"}})],1)],1)],1),t._v(" "),r("el-col",{attrs:{md:24}},[r("el-form-item",{attrs:{label:"Selecciona Equipo",prop:"product_id"}},[r("el-select",{attrs:{placeholder:"Selecciona un equipo"},model:{value:t.form.product_id,callback:function(e){t.$set(t.form,"product_id",e)},expression:"form.product_id"}},t._l(t.products,(function(t){return r("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1)],1),t._v(" "),r("el-col",{attrs:{md:24}},[r("div",{staticClass:"content-space",staticStyle:{"text-align":"right"}},[r("el-button",{attrs:{type:"info"},on:{click:function(e){t.openAddProduct=!1}}},[t._v("Cancelar")]),t._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:function(e){return e.stopPropagation(),t.submitForm("formProduct")}}},[t._v("Asignar producto")])],1)])],1)],1)],1)],1)}),[],!1,null,null,null).exports,m={layout:"dashboard",middleware:["auth"],transition:{name:"default",mode:"out-in"},components:{TitleSection:o.a,TableProducts:d},head:function(){return{title:"Actualización de cliente"}},data:function(){return{form:{role:"client",password:"",business_name:"",rfc:"",company_name:""},rules:{name:[{required:!0,message:"Agrega nombre",trigger:"blur"}],last_name:[{required:!0,message:"Agrega apellido",trigger:"blur"}],email:[{required:!0,message:"Agrega un correo",trigger:"blur"}],company_name:[{required:!0,message:"Agrega el nombre de la empresa",trigger:"blur"}]},products:[]}},methods:{submitForm:function(t){var e=this;this.$refs[t].validate((function(t){if(!t)return!1;e.$axios.patch("http://api.diken.mx/api/clients/"+e.$route.params.client_id,e.form).then((function(t){e.$notify({title:"Notificación",message:"El cliente fue actualizado correctamente",type:"success"})})).catch((function(t){e.$notify.error({title:"Error",message:"El cliente no ha posido ser actualizado"})}))}))},getUser:function(){var t=this;this.$axios.get("http://api.diken.mx/api/clients/"+this.$route.params.client_id).then((function(e){t.form=e.data.data.user})).catch((function(t){console.log("error")}))},getProducts:function(){var t=this;this.$axios.get("http://api.diken.mx/api/clients/"+this.$route.params.client_id+"/product-relation").then((function(e){t.products=e.data.data.rows})).catch((function(t){console.log("error",t)}))}},mounted:function(){this.getUser(),this.getProducts()}},f=Object(l.a)(m,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[r("el-breadcrumb-item",{attrs:{to:{path:"/clients"}}},[t._v("Clientes")]),t._v(" "),r("el-breadcrumb-item",[t._v("Detalle de cliente")])],1),t._v(" "),r("el-row",{staticClass:"group-title"},[r("el-col",{attrs:{md:12}},[r("TitleSection",{attrs:{title:"Cliente"}})],1)],1),t._v(" "),r("el-row",[r("el-form",{ref:"formUser",staticClass:"form-style-curds",attrs:{rules:t.rules,model:t.form}},[r("el-col",{attrs:{md:24}},[r("div",{staticClass:"content-space"},[r("p",[t._v("Información de la empresa")])])]),t._v(" "),r("el-row",[r("el-col",{attrs:{md:6}},[r("el-form-item",{attrs:{label:"Razón social",prop:"business_name"}},[r("el-input",{model:{value:t.form.business_name,callback:function(e){t.$set(t.form,"business_name",e)},expression:"form.business_name"}})],1)],1),t._v(" "),r("el-col",{attrs:{md:6}},[r("el-form-item",{attrs:{label:"RFC",prop:"rfc"}},[r("el-input",{model:{value:t.form.rfc,callback:function(e){t.$set(t.form,"rfc",e)},expression:"form.rfc"}})],1)],1),t._v(" "),r("el-col",{attrs:{md:6}},[r("el-form-item",{attrs:{label:"Nombre de la empresa",prop:"company_name"}},[r("el-input",{model:{value:t.form.company_name,callback:function(e){t.$set(t.form,"company_name",e)},expression:"form.company_name"}})],1)],1)],1),t._v(" "),r("el-col",{attrs:{md:24}},[r("div",{staticClass:"content-space"},[r("p",[t._v("Datos de acceso a la plataforma")])])]),t._v(" "),r("el-row",[r("el-col",{attrs:{md:6}},[r("el-form-item",{attrs:{label:"Nombre completo",prop:"name"}},[r("el-input",{attrs:{required:""},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1)],1),t._v(" "),r("el-col",{attrs:{xs:12,md:6}},[r("el-form-item",{attrs:{label:"Apellido Paterno",prop:"last_name"}},[r("el-input",{model:{value:t.form.last_name,callback:function(e){t.$set(t.form,"last_name",e)},expression:"form.last_name"}})],1)],1),t._v(" "),r("el-col",{attrs:{xs:12,md:6}},[r("el-form-item",{attrs:{label:"Apellido Materno",prop:"second_last_name"}},[r("el-input",{model:{value:t.form.second_last_name,callback:function(e){t.$set(t.form,"second_last_name",e)},expression:"form.second_last_name"}})],1)],1)],1),t._v(" "),r("el-row",[r("el-col",{attrs:{md:6}},[r("el-form-item",{attrs:{label:"Correo electrónico",prop:"email"}},[r("el-input",{model:{value:t.form.email,callback:function(e){t.$set(t.form,"email",e)},expression:"form.email"}})],1)],1),t._v(" "),r("el-col",{attrs:{md:6}},[r("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Agrega una contraseña, solo si deseas hacer el cambio.",placement:"top-start"}},[r("el-form-item",{attrs:{label:"Nueva Contraseña",prop:"password"}},[r("el-input",{attrs:{type:"password"},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})],1)],1)],1)],1),t._v(" "),t.$currentRole(["admin"])?r("el-col",{attrs:{md:24}},[r("div",{staticClass:"content-space"},[r("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submitForm("formUser")}}},[t._v("Actualizar cliente")])],1)]):t._e(),t._v(" "),r("el-col",{attrs:{md:24}},[r("TableProducts",{attrs:{data:t.products},on:{updateProductsList:function(e){return t.getProducts()}}})],1)],1)],1)],1)}),[],!1,null,null,null);e.default=f.exports}}]);