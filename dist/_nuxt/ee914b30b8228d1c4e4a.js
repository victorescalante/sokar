(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{474:function(e,t,r){var content=r(476);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(19).default)("8183a152",content,!0,{sourceMap:!1})},475:function(e,t,r){"use strict";var o=r(474);r.n(o).a},476:function(e,t,r){(t=r(18)(!1)).push([e.i,".custom-card-table{padding-bottom:50px}.custom-card-table .title{border-radius:5px}.custom-card-table.purple .title{background:#fff}.custom-card-table.yellow .title{background:#e5e500;color:#000}.custom-card-table.orange .title{background:#ff4500;color:#fff}.custom-card-table.green .title{background:#33b105;color:#fff}.custom-card-table.purple .title{background:#9103b1;color:#fff}.custom-card-table .title{background:#0767c6;padding:15px;color:#fff;font-weight:700}.custom-card-table .actions{text-align:right;padding:10px 15px}.custom-card-table .content{padding:15px}.custom-paginator{padding:25px}",""]),e.exports=t},477:function(e,t,r){"use strict";var o={name:"TableGeneral",props:["title","color"]},l=(r(475),r(10)),component=Object(l.a)(o,(function(){var e=this.$createElement,t=this._self._c||e;return t("div",{class:" custom-card-table "+this.color},[t("div",{staticClass:"title"},[this._v(this._s(this.title))]),this._v(" "),this._t("default")],2)}),[],!1,null,null,null);t.a=component.exports},478:function(e,t,r){var content=r(480);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(19).default)("5e148abe",content,!0,{sourceMap:!1})},479:function(e,t,r){"use strict";var o=r(478);r.n(o).a},480:function(e,t,r){(t=r(18)(!1)).push([e.i,".TitleSection{color:#409eff;padding:25px 15px;text-transform:uppercase}",""]),e.exports=t},481:function(e,t,r){"use strict";var o={props:["title"]},l=(r(479),r(10)),component=Object(l.a)(o,(function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"TitleSection"},[t("h2",[this._v(this._s(this.title))])])}),[],!1,null,null,null);t.a=component.exports},499:function(e,t,r){var content=r(535);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(19).default)("01e33cca",content,!0,{sourceMap:!1})},534:function(e,t,r){"use strict";var o=r(499);r.n(o).a},535:function(e,t,r){(t=r(18)(!1)).push([e.i,".report .el-row{padding-top:15px}.report .el-card{margin-top:15px}",""]),e.exports=t},558:function(e,t,r){"use strict";r.r(t);r(20);var o=r(3),l=r(481),n=r(477),c=r(482),d=r.n(c),m={layout:"dashboard",middleware:["auth"],transition:{name:"default",mode:"out-in"},components:{TitleSection:l.a,TableGeneral:n.a},head:function(){return{title:"Actualización de servicio"}},data:function(){return{loading:!1,notUpdate:!1,catalog_repairs:[],report:{},dialogImageUrl:"",dialogVisible:!1,upload:{url:"//api.diken.mx/api/files",headers:{Authorization:this.$auth.getToken("local")},data:{model_id:"",model:0},list:[]},rules:{costs:[{required:!0,message:"Ingresa un costo",trigger:"blur"}]}}},methods:{saveFile:function(e){return{category:e,model_id:this.upload.data.model_id,model:this.upload.data.model}},filterImagesByCategory:function(e){return d.a.filter(this.upload.list,{category:e})},handleRemove:function(e,t){var r=this;return Object(o.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.$axios.$delete("//api.diken.mx/api/files/"+e.id);case 2:case"end":return t.stop()}}),t)})))()},handlePictureCardPreview:function(e){this.dialogImageUrl=e.url,this.dialogVisible=!0},AddExtraCost:function(){this.report.costs.unshift({description:"",cost:0})},AddExtraCostRepair:function(){this.report.costs_repairs.unshift({repair_id:"",cost:0})},init:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var data,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$axios.$get("//api.diken.mx/api/services/"+e.$route.params.service_id+"/reports/"+e.$route.params.id);case 2:return data=t.sent,t.next=5,e.$axios.$get("//api.diken.mx/api/repairs/?limit=350&order_by=name");case 5:return r=t.sent,t.next=8,r.data.rows;case 8:return e.catalog_repairs=t.sent,t.next=11,data.data.report;case 11:e.report=t.sent,e.upload.data.model=data.data.report.model,e.upload.data.model_id=data.data.report.id,e.upload.list=d.a.map(data.data.report.files,(function(e){return{name:"name",url:e.url,id:e.id,category:e.category}}));case 15:case"end":return t.stop()}}),t)})))()},submitForm:function(e){var t=this;this.loading=!0,this.$refs[e].validate((function(e){if(!e)return t.loading=!1,!1;t.$axios.patch("//api.diken.mx/api/services/"+t.$route.params.service_id+"/reports/"+t.$route.params.id,t.report).then((function(e){t.$notify({title:"Correcto",message:"El reporte ha sido actualizado",type:"success"}),t.report=e.data.data.report,t.loading=!1})).catch((function(e){t.$notify.error({title:"Error",message:"El reporte no ha podido ser actualizado"}),t.loading=!1}))}))}},mounted:function(){},fetch:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.init();case 2:case"end":return t.stop()}}),t)})))()}},v=(r(534),r(10)),component=Object(v.a)(m,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"report"},[e.$fetchState.pending?r("p",{staticClass:"primary-color"},[e._v("Cargando datos del reporte ...")]):r("TableGeneral",{attrs:{title:"Reporte de actividades",color:"purple"}},[r("el-row",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[r("el-col",{attrs:{md:24}},[r("el-card",[r("p",[e._v("Este es el reporte detallado para el producto "),r("b",[e._v(e._s(e.report.product_user.product.name))]),e._v("\n            el cual se encuentra asociado al cliente "),r("b",[e._v(e._s(e.report.product_user.client.company_name))])])]),e._v(" "),r("el-card",[r("el-row",{staticStyle:{"text-align":"center"}},[r("el-col",{attrs:{md:8}},[r("p",[r("b",[e._v("Progreso de servicio")])]),e._v(" "),r("br"),e._v(" "),r("el-progress",{attrs:{percentage:e.report.progress}})],1),e._v(" "),r("el-col",{attrs:{md:8}},[r("p",[r("b",[e._v("Creación del reporte")])]),e._v(" "),r("br"),e._v(" "),r("p",[e._v(e._s(e.$convertDateToHuman(e.report.created_at)))])]),e._v(" "),r("el-col",{attrs:{md:8}},[r("p",[r("b",[e._v("Última actualización")])]),e._v(" "),r("br"),e._v(" "),r("p",[e._v(e._s(e.$convertDateToHuman(e.report.updated_at)))])])],1)],1),e._v(" "),r("el-form",{ref:"reportForm",attrs:{model:e.report,rules:e.rules}},[r("el-card",[r("el-row",{attrs:{gutter:25}},[r("el-col",{attrs:{md:24}},[r("h3",{staticStyle:{padding:"20px 0px"}},[e._v("Datos del reporte")])]),e._v(" "),r("el-col",{attrs:{md:8}},[r("el-form-item",{attrs:{label:"Fecha de inicio",prop:"service_start"}},[r("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"Fecha de inicio"},model:{value:e.report.service_start,callback:function(t){e.$set(e.report,"service_start",t)},expression:"report.service_start"}})],1)],1),e._v(" "),r("el-col",{attrs:{md:8}},[r("el-form-item",{attrs:{label:"Fecha de termino",prop:"service_end"}},[r("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"Aún no es asignada la fecha de termino"},model:{value:e.report.service_end,callback:function(t){e.$set(e.report,"service_end",t)},expression:"report.service_end"}})],1)],1),e._v(" "),r("el-col",{attrs:{md:8}},[r("el-form-item",{attrs:{label:"Estatus de reporte",prop:"status"}},[r("el-select",{attrs:{placeholder:"Selecciona un estatus"},model:{value:e.report.status,callback:function(t){e.$set(e.report,"status",t)},expression:"report.status"}},[r("el-option",{attrs:{label:"Pendiente",value:"pendiente"}}),e._v(" "),r("el-option",{attrs:{label:"Cancelado",value:"cancelado"}}),e._v(" "),r("el-option",{attrs:{label:"En proceso",value:"en_proceso"}}),e._v(" "),r("el-option",{attrs:{label:"Terminado",value:"terminado"}})],1)],1)],1)],1),e._v(" "),r("el-row",[r("el-col",{attrs:{md:24}},[r("el-form-item",{attrs:{label:"Observaciones y correcciones del servicio"}},[r("el-input",{attrs:{type:"textarea",rows:"5"},model:{value:e.report.description,callback:function(t){e.$set(e.report,"description",t)},expression:"report.description"}})],1)],1)],1),e._v(" "),r("el-row",{attrs:{gutter:25}},[r("el-col",{attrs:{md:24}},[r("h3",{staticStyle:{padding:"20px 0"}},[e._v("Forma de uso encontrada")])]),e._v(" "),r("el-col",{attrs:{md:8}},[r("el-form-item",{attrs:{label:"Dilución",prop:"dilution"}},[r("el-input",{model:{value:e.report.dilution,callback:function(t){e.$set(e.report,"dilution",t)},expression:"report.dilution"}})],1)],1),e._v(" "),r("el-col",{attrs:{md:8}},[r("el-form-item",{attrs:{label:"Frecuencía",prop:"frequency"}},[r("el-input",{model:{value:e.report.frequency,callback:function(t){e.$set(e.report,"frequency",t)},expression:"report.frequency"}})],1)],1),e._v(" "),r("el-col",{attrs:{md:8}},[r("el-form-item",{attrs:{label:"Método",prop:"method"}},[r("el-input",{model:{value:e.report.method,callback:function(t){e.$set(e.report,"method",t)},expression:"report.method"}})],1)],1)],1),e._v(" "),r("el-row",{attrs:{gutter:25}},[r("el-col",{attrs:{md:12}},[r("h3",{staticStyle:{padding:"20px 0"}},[e._v("Costos extras")]),e._v(" "),r("el-button",{attrs:{type:"primary",plain:""},on:{click:e.AddExtraCost}},[e._v("Agregar un costo extra")]),e._v(" "),e.report.costs.length>0?r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{md:16}},[e._v("Descripción")]),e._v(" "),r("el-col",{attrs:{md:8}},[e._v("Costo")])],1):e._e(),e._v(" "),e._l(e.report.costs,(function(t,o){return r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{md:16}},[r("el-input",{attrs:{type:"text",placeholder:"Descripción del costo"},model:{value:t.description,callback:function(r){e.$set(t,"description",r)},expression:"cost.description"}})],1),e._v(" "),r("el-col",{attrs:{md:8}},[r("el-input",{attrs:{type:"number",placeholder:"Costo"},model:{value:t.cost,callback:function(r){e.$set(t,"cost",r)},expression:"cost.cost"}})],1)],1)}))],2),e._v(" "),r("el-col",{attrs:{md:12}},[r("h3",{staticStyle:{padding:"20px 0"}},[e._v("Costos de refacciones")]),e._v(" "),r("el-button",{attrs:{type:"primary",plain:""},on:{click:e.AddExtraCostRepair}},[e._v("Agregar una refacción")]),e._v(" "),e.report.costs_repairs.length>0?r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{md:16}},[e._v("Refacción")]),e._v(" "),r("el-col",{attrs:{md:8}},[e._v("Costo")])],1):e._e(),e._v(" "),e._l(e.report.costs_repairs,(function(t){return r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{md:16}},[r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"Selecciona una refacción",filterable:""},model:{value:t.repair_id,callback:function(r){e.$set(t,"repair_id",r)},expression:"cost.repair_id"}},e._l(e.catalog_repairs,(function(e){return r("el-option",{attrs:{label:e.name,value:e.id}})})),1)],1),e._v(" "),r("el-col",{attrs:{md:8}},[r("el-input",{attrs:{type:"number",placeholder:"Costo"},model:{value:t.cost,callback:function(r){e.$set(t,"cost",r)},expression:"cost.cost"}})],1)],1)}))],2)],1),e._v(" "),r("el-row",[r("el-col",{attrs:{md:24}},[r("h3",{staticStyle:{padding:"20px 0"}},[e._v("Adjuntar evidencía")])]),e._v(" "),r("el-col",{attrs:{md:24}},[r("div",{staticClass:"images-upload"},[r("el-upload",{attrs:{accept:"image/png, image/jpeg",action:e.upload.url,multiple:!0,headers:e.upload.headers,data:e.saveFile("report"),"file-list":e.filterImagesByCategory("report"),"list-type":"picture-card","on-preview":e.handlePictureCardPreview,"on-remove":e.handleRemove}},[r("i",{staticClass:"el-icon-plus"})]),e._v(" "),r("el-dialog",{attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})])],1)])],1),e._v(" "),r("el-row",[r("el-col",{attrs:{md:24}},[r("div",{staticStyle:{padding:"25px 0"}},[r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("reportForm")}}},[e._v("Actualizar reporte")])],1)])],1)],1)],1)],1)],1)],1)],1)}),[],!1,null,null,null);t.default=component.exports}}]);