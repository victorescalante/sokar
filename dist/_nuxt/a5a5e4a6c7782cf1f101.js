(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{478:function(e,t,r){var content=r(480);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(19).default)("5e148abe",content,!0,{sourceMap:!1})},479:function(e,t,r){"use strict";var o=r(478);r.n(o).a},480:function(e,t,r){(t=r(18)(!1)).push([e.i,".TitleSection{color:#409eff;padding:25px 15px;text-transform:uppercase}",""]),e.exports=t},481:function(e,t,r){"use strict";var o={props:["title"]},n=(r(479),r(10)),component=Object(n.a)(o,(function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"TitleSection"},[t("h2",[this._v(this._s(this.title))])])}),[],!1,null,null,null);t.a=component.exports},493:function(e,t,r){var content=r(521);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(19).default)("9c4374f4",content,!0,{sourceMap:!1})},520:function(e,t,r){"use strict";var o=r(493);r.n(o).a},521:function(e,t,r){(t=r(18)(!1)).push([e.i,".product-card{cursor:pointer;padding:15px;border:1px solid #2d9c03;border-radius:10px;text-align:center}.product-card.cancel{border:1px solid #3c5fe0}.product-card.cancel .product_name{color:#3c5fe0}.product-card.danger{border:1px solid #d90e0e}.product-card.danger .product_name{color:#d90e0e}.product-card .date{font-size:12px}.product-card .date p{font-weight:700}.product-card .serial_number{font-size:10px}.product-card .product_name{color:#2d9c03;font-weight:700;padding:0}.mini-form-product label{display:block;width:100%;text-align:left}.mini-form-product .el-select{width:100%}.table-products{padding:25px 15px}.table-products .body-products,.table-products .body-products .row-custom,.table-products p{padding-top:15px}.table-products .body-products .row-custom.row-header{font-weight:700}",""]),e.exports=t},536:function(e,t,r){"use strict";r.r(t);var o=r(481),n=(r(20),r(3)),c=(r(0),{name:"TableProducts",props:["data","color"],data:function(){return{loadingProduct:!1,windowWidth:0,openAddProduct:!1,products:[],form:{product_type:"",product_id:"",status:!0}}},mounted:function(){var e=this;this.windowWidth=window.innerWidth,window.addEventListener("resize",(function(){e.windowWidth=window.innerWidth}))},fetch:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getProducts();case 2:case"end":return t.stop()}}),t)})))()},methods:{getProducts:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$axios.$get("//api.diken.mx/api/products");case 2:r=t.sent,e.products=r.data.rows;case 4:case"end":return t.stop()}}),t)})))()},redirectRelation:function(e){this.$router.push("/clients/"+this.$route.params.client_id+"/product-relation/"+e)},checkDate:function(e){var t=new Date(e).getTime();return Date.now()-t>=0?"danger":""},submitForm:function(e){var t=this;this.loadingProduct=!0,this.$refs[e].validate((function(e){if(!e)return!1;t.$axios.post("//api.diken.mx/api/clients/"+t.$route.params.client_id+"/product-relation",t.form).then((function(e){t.$notify({title:"Correcto",message:"El producto fue asignado correctamente",type:"success"}),t.$emit("updateProductsList"),t.openAddProduct=!1,t.loadingProduct=!1})).catch((function(e){console.log("El servicio no ha posido ser creado"),t.loadingProduct=!1}))}))}}}),l=(r(520),r(10)),d=Object(l.a)(c,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"table-products"},[r("el-row",[r("el-col",{attrs:{md:24}},[r("h3",[e._v("Administrar los equipos del cliente")]),e._v(" "),r("br"),e._v(" "),r("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){e.openAddProduct=!0}}},[e._v("Agregar equipo a cliente")]),e._v(" "),e.data.length>=1?r("el-button",{attrs:{type:"info",plain:""},on:{click:function(t){return e.$router.push("/services/create")}}},[e._v("Realizar mantenimiento")]):e._e()],1),e._v(" "),r("el-col",{attrs:{md:24}},[r("p",{staticStyle:{padding:"25px 0"}},[r("strong",[e._v("Número de serie:")]),e._v(" El número de serie es asignado al momento de agregar un producto del catálogo al cliente.")])])],1),e._v(" "),r("div",{staticClass:"body-products"},[r("el-row",{attrs:{gutter:15}},e._l(e.data,(function(t){return r("el-col",{staticStyle:{"padding-top":"15px"},attrs:{xs:12,md:8}},[r("div",{staticClass:"product-card",class:e.checkDate(t.next_service),on:{click:function(r){return e.redirectRelation(t.id)}}},[r("el-row",[r("el-col",{attrs:{md:24}},[r("p",{staticClass:"product_name"},[e._v(e._s(t.product.name))]),e._v(" "),r("p",{staticClass:"serial_number"},[e._v(e._s(t.serial_number))])])],1),e._v(" "),r("el-row",{staticClass:"date"},[r("el-col",{attrs:{md:24}},[r("p",[e._v("Última fecha de servicio")]),e._v(" "),r("span",[e._v(e._s(e.$convertDate(t.last_service)))])]),e._v(" "),r("el-col",{attrs:{md:24}},[r("p",[e._v("Proxima fecha de servicio")]),e._v(" "),r("span",[e._v(e._s(e.$convertDate(t.next_service)))])])],1),e._v(" "),r("el-row",[r("el-col",{attrs:{md:12,offset:12}})],1)],1)])})),1)],1),e._v(" "),r("el-dialog",{attrs:{title:"Asignar equipo a cliente",visible:e.openAddProduct,width:e.$getWidthModal(e.windowWidth)},on:{"update:visible":function(t){e.openAddProduct=t}}},[r("el-row",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingProduct,expression:"loadingProduct"}]},[r("el-form",{ref:"formProduct",staticClass:"mini-form-product",attrs:{model:e.form}},[r("el-col",{attrs:{md:24}},[r("el-form-item",{attrs:{label:"Tipo de Equipo"}},[r("el-select",{attrs:{placeholder:"Selecciona el tipo de equipo"},model:{value:e.form.product_type,callback:function(t){e.$set(e.form,"product_type",t)},expression:"form.product_type"}},[r("el-option",{attrs:{label:"Propio",value:"own"}}),e._v(" "),r("el-option",{attrs:{label:"Comodato",value:"borrowed"}})],1)],1)],1),e._v(" "),r("el-col",{attrs:{md:24}},[r("el-form-item",{attrs:{label:"Selecciona Equipo",prop:"product_id"}},[r("el-select",{attrs:{placeholder:"Selecciona un equipo"},model:{value:e.form.product_id,callback:function(t){e.$set(e.form,"product_id",t)},expression:"form.product_id"}},e._l(e.products,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1),e._v(" "),r("el-col",{attrs:{md:24}},[r("div",{staticClass:"content-space",staticStyle:{"text-align":"right"}},[r("el-button",{attrs:{type:"info"},on:{click:function(t){e.openAddProduct=!1}}},[e._v("Cancelar")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:function(t){return t.stopPropagation(),e.submitForm("formProduct")}}},[e._v("Asignar producto")])],1)])],1)],1)],1)],1)}),[],!1,null,null,null).exports,m={layout:"dashboard",middleware:["auth"],transition:{name:"default",mode:"out-in"},components:{TitleSection:o.a,TableProducts:d},head:function(){return{title:"Actualización de cliente"}},data:function(){return{form:{role:"client",password:"",business_name:"",rfc:"",company_name:""},rules:{name:[{required:!0,message:"Agrega nombre",trigger:"blur"}],last_name:[{required:!0,message:"Agrega apellido",trigger:"blur"}],email:[{required:!0,message:"Agrega un correo",trigger:"blur"}],company_name:[{required:!0,message:"Agrega el nombre de la empresa",trigger:"blur"}]},products:[]}},methods:{submitForm:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;t.$axios.patch("//api.diken.mx/api/clients/"+t.$route.params.client_id,t.form).then((function(e){t.$notify({title:"Notificación",message:"El cliente fue actualizado correctamente",type:"success"})})).catch((function(e){t.$notify.error({title:"Error",message:"El cliente no ha posido ser actualizado"})}))}))},getUser:function(){var e=this;this.$axios.get("//api.diken.mx/api/clients/"+this.$route.params.client_id).then((function(t){e.form=t.data.data.user})).catch((function(e){console.log("error")}))},getProducts:function(){var e=this;this.$axios.get("//api.diken.mx/api/clients/"+this.$route.params.client_id+"/product-relation").then((function(t){e.products=t.data.data.rows})).catch((function(e){console.log("error",e)}))}},mounted:function(){this.getUser(),this.getProducts()}},f=Object(l.a)(m,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[r("el-breadcrumb-item",{attrs:{to:{path:"/clients"}}},[e._v("Clientes")]),e._v(" "),r("el-breadcrumb-item",[e._v("Detalle de cliente")])],1),e._v(" "),r("el-row",{staticClass:"group-title"},[r("el-col",{attrs:{md:12}},[r("TitleSection",{attrs:{title:"Cliente"}})],1)],1),e._v(" "),r("el-row",[r("el-form",{ref:"formUser",staticClass:"form-style-curds",attrs:{rules:e.rules,model:e.form}},[r("el-col",{attrs:{md:24}},[r("div",{staticClass:"content-space"},[r("p",[e._v("Información de la empresa")])])]),e._v(" "),r("el-row",[r("el-col",{attrs:{md:6}},[r("el-form-item",{attrs:{label:"Razón social",prop:"business_name"}},[r("el-input",{model:{value:e.form.business_name,callback:function(t){e.$set(e.form,"business_name",t)},expression:"form.business_name"}})],1)],1),e._v(" "),r("el-col",{attrs:{md:6}},[r("el-form-item",{attrs:{label:"RFC",prop:"rfc"}},[r("el-input",{model:{value:e.form.rfc,callback:function(t){e.$set(e.form,"rfc",t)},expression:"form.rfc"}})],1)],1),e._v(" "),r("el-col",{attrs:{md:6}},[r("el-form-item",{attrs:{label:"Nombre de la empresa",prop:"company_name"}},[r("el-input",{model:{value:e.form.company_name,callback:function(t){e.$set(e.form,"company_name",t)},expression:"form.company_name"}})],1)],1)],1),e._v(" "),r("el-col",{attrs:{md:24}},[r("div",{staticClass:"content-space"},[r("p",[e._v("Datos de acceso a la plataforma")])])]),e._v(" "),r("el-row",[r("el-col",{attrs:{md:6}},[r("el-form-item",{attrs:{label:"Nombre completo",prop:"name"}},[r("el-input",{attrs:{required:""},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1)],1),e._v(" "),r("el-col",{attrs:{xs:12,md:6}},[r("el-form-item",{attrs:{label:"Apellido Paterno",prop:"last_name"}},[r("el-input",{model:{value:e.form.last_name,callback:function(t){e.$set(e.form,"last_name",t)},expression:"form.last_name"}})],1)],1),e._v(" "),r("el-col",{attrs:{xs:12,md:6}},[r("el-form-item",{attrs:{label:"Apellido Materno",prop:"second_last_name"}},[r("el-input",{model:{value:e.form.second_last_name,callback:function(t){e.$set(e.form,"second_last_name",t)},expression:"form.second_last_name"}})],1)],1)],1),e._v(" "),r("el-row",[r("el-col",{attrs:{md:6}},[r("el-form-item",{attrs:{label:"Correo electrónico",prop:"email"}},[r("el-input",{model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1)],1),e._v(" "),r("el-col",{attrs:{md:6}},[r("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Agrega una contraseña, solo si deseas hacer el cambio.",placement:"top-start"}},[r("el-form-item",{attrs:{label:"Nueva Contraseña",prop:"password"}},[r("el-input",{attrs:{type:"password"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1)],1)],1)],1),e._v(" "),e.$currentRole(["admin"])?r("el-col",{attrs:{md:24}},[r("div",{staticClass:"content-space"},[r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("formUser")}}},[e._v("Actualizar cliente")])],1)]):e._e(),e._v(" "),r("el-col",{attrs:{md:24}},[r("TableProducts",{attrs:{data:e.products},on:{updateProductsList:function(t){return e.getProducts()}}})],1)],1)],1)],1)}),[],!1,null,null,null);t.default=f.exports}}]);